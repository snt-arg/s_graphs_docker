!function(t,e,i){"function"==typeof define&&define.amd?define("begrid",e):"object"==typeof module&&module.exports?module.exports=e(i):t.BeGrid=e(i)}(window,function(o){"use strict";var r=o(window),t=function(t){null==t||o(t).hasClass("be-grid-initialized")||(this.init(t),r.load(function(){this.ele.isotope("layout")}.bind(this)))};return t.prototype.init=function(t){null!=t&&(this.ele=o(t),this.setDefaultProps(),this.setLayout(),this.setGutter(),this.initGridAnimation(),this.grid(),this.initEvents(),this.filterItems())},t.prototype.initEvents=function(){r.on("load",function(){this.ele.isotope("layout")}.bind(this)),r.on("debouncedresize",function(){var t=this.ele.find("audio, video"),e=this.ele.find(".be-slider");this.grid(),0<t.length&&t.each(function(){var t=o(this).data().mediaelementplayer;"object"==typeof t&&(t.setPlayerSize(),t.setControlsSize())}),0<e.length&&(e.each(function(){var t=o(this);t.hasClass("flickity-enabled")&&t.flickity("reposition")}),this.ele.isotope("layout"))}.bind(this))},t.prototype.setDefaultProps=function(){this.cols=3,this.gutter=0,this.elementsToReveal=null,this.animationType="revealAllAtOnce",this.layout="masonry"},t.prototype.setGutter=function(){this.gutter=parseInt(this.ele.attr("data-gutter"))||0},t.prototype.setLayout=function(){"metro"===this.ele.attr("data-layout")&&(this.layout="metro")},t.prototype.setCols=function(){var t=parseInt(this.ele.attr("data-cols"))||3,e=r.width();if(1024<e)this.cols=t;else if(959<e)switch(t){case 1:this.cols=1;break;case 2:this.cols=2;break;case 3:default:this.cols=3}else 767<e?this.cols=1==t?1:2:null!=this.ele.attr("data-mobile-cols")?this.cols=parseInt(this.ele.attr("data-mobile-cols")):this.cols=1},t.prototype.initGridAnimation=function(){this.animationType="1"===this.ele.attr("data-scroll-reveal")?"scrollReveal":"revealAllAtOnce",this.elementsToReveal=this.ele.find(".be-col"),this.addAnimationClass(),"scrollReveal"===this.animationType&&r.on("scroll",function(){this.triggerScrollReveal()}.bind(this))},t.prototype.addAnimationClass=function(){var t=this.ele.attr("data-animation-target")||".be-col",e=this.ele.attr("data-animation")||"be-col-hide";this.ele.find(t).addClass(e)},t.prototype.triggerScrollReveal=function(){if("scrollReveal"===this.animationType&&0<this.elementsToReveal.length){var t=this.elementsToReveal.filter(function(){return o(this).isVisible(-100)});0<t.length&&(t.each(function(t,e){var i=o(e),s=null==this.ele.attr("data-animation")?"be-col-visible":"be-start-animation",a=this.ele.attr("data-animation-target");null!=a&&(i=i.find(a)),i.css("transition-delay",150*t+"ms"),i.addClass(s)}.bind(this)),this.elementsToReveal=this.elementsToReveal.not(t))}},t.prototype.filterItems=function(){"1"===this.ele.attr("data-filter-items")&&this.ele.parent().on("click",".sort-items",function(t){var e=o(t.currentTarget).data("id"),i=o([]);if(!o(t.currentTarget).hasClass("current_choice")){this.ele.parent().find(".sort-items").removeClass("current_choice"),o(t.currentTarget).addClass("current_choice");var s=this.ele.find(".be-col");s.css({transform:"scale(0)",transition:"all 0.3s ease"}),setTimeout(function(){s.find(".be-start-animation").css("transition-delay",""),s.css({transform:"",transition:""}),this.ele.isotope({filter:function(){var t=o(this).data("category-names");if("all"===e||-1<t.indexOf(e))return i=i.add(o(this)),!0},transitionDuration:0}),i.find(".be-start-animation").removeClass("be-start-animation"),this.elementsToReveal=i,setTimeout(function(){"scrollReveal"===this.animationType?this.triggerScrollReveal():this.revealAllAtOnce()}.bind(this),0)}.bind(this),300)}}.bind(this))},t.prototype.revealAllAtOnce=function(){"revealAllAtOnce"===this.animationType&&0<this.elementsToReveal.length&&(this.elementsToReveal.each(function(t,e){var i=o(e),s=null==this.ele.attr("data-animation")?"be-col-visible":"be-start-animation",a=this.ele.attr("data-animation-target");null!=a&&(i=i.find(a)),i.css("transition-delay",150*t+"ms"),i.addClass(s)}.bind(this)),this.elementsToReveal=o([]))},t.prototype.grid=function(){this.setCols(),this.setWidth(),this.setGiantCells(),this.renderLayout()},t.prototype.setWidth=function(){this.ele.width("");var t,e,i=this.ele.width(),s=r.width(),a=this.ele.find(".be-col");console.log(i),i=Math.floor(i/this.cols)*this.cols+this.cols,console.log(i),this.ele.width(i),e=i/this.cols,"masonry"==this.layout||767<s&&0<(t=a.filter(function(){return o(this).hasClass("be-double-width-cell")||o(this).hasClass("be-double-width-height-cell")})).length&&(a=a.not(t),t.outerWidth(2*e)),a.outerWidth(e)},t.prototype.setGiantCells=function(){if("metro"==this.layout){var t=isNaN(parseFloat(this.ele.attr("data-aspect-ratio")))?1:parseFloat(this.ele.attr("data-aspect-ratio")),a=this.ele.width()/this.cols-this.gutter,l=r.width(),n=a/t,e=(n=Math.round(100*n)/100,this.ele.find(".be-double-width-cell")),i=this.ele.find(".be-double-height-cell"),s=this.ele.find(".be-double-width-height-cell");0<e.length&&e.each(function(t,e){var i,s=o(e);i=767<l?n/(2*a+this.gutter):n/a,isNaN(i)||(i*=100,s.find(".be-grid-placeholder").css("padding-bottom",i+"%"))}.bind(this)),0<i.length&&i.each(function(t,e){var i=o(e),s=(2*n+this.gutter)/a;isNaN(s)||(s*=100,i.find(".be-grid-placeholder").css("padding-bottom",s+"%"))}.bind(this)),0<s.length&&s.each(function(t,e){var i,s=o(e);i=767<l?(2*n+this.gutter)/(2*a+this.gutter):(2*n+this.gutter)/a,isNaN(i)||(i*=100,s.find(".be-grid-placeholder").css("padding-bottom",i+"%"))}.bind(this))}},t.prototype.renderLayout=function(){var t=this.ele.width()/this.cols;this.ele.isotope({isInitLayout:!1,itemSelector:".be-col",resize:!1,masonry:{columnWidth:t}}),this.ele.on("layoutComplete",function(){this.ele.hasClass("be-grid-initialized")||(this.ele.addClass("be-grid-initialized"),setTimeout(function(){"scrollReveal"===this.animationType?this.triggerScrollReveal():this.revealAllAtOnce(),BeLazyLoad.lazyLoad()}.bind(this),0))}.bind(this)),this.ele.isotope()},t},jQuery);
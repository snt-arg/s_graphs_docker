!function(e){"use strict";function n(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e}function t(e,t){this.el=e,this.options=n({},this.options),n(this.options,t),this.menus=jQuery(this.el).find(".menu-container").toArray(),this.current=0,this._init()}var i=Modernizr.cssanimations,a={WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",animation:"animationend"}[Modernizr.prefixed("animation")],s=function(e,n){var t=function(e){if(i){if(e.target!=this)return;this.removeEventListener(a,t)}n&&"function"==typeof n&&n.call()};i?e.addEventListener(a,t):t()};t.prototype.options={breadcrumbsCtrl:!1,initialBreadcrumb:"all",backCtrl:!0,initialDelay:200,itemsDelayInterval:60,direction:"r2l",onItemClick:function(e,n){return!1}},t.prototype._init=function(){this.menusArr=[];var e=this,n=jQuery(".be-sidemenu").attr("data-menu-alignment");if(this.options.backCtrl&&(this.backCtrl=document.createElement("button"),this.backCtrl.className="menu__back menu__back--hidden",this.backCtrl.setAttribute("aria-label","Go back"),this.backCtrl.innerHTML='<span class="icon icon--arrow-left"></span>'),jQuery("body").hasClass("overlay-left-align-menu")&&jQuery(".special-header-bottom-text").length>0){var t=jQuery(".special-header-bottom-text");t[0].clientHeight==t[0].scrollHeight&&jQuery(t).css("align-self",n)}this.menus.forEach(function(t,i){jQuery(t).hasClass("sub-menu")&&jQuery(t).prepend("<li class='menu-item'><span class = 'menu__back'><span class = 'icon icon--arrow-left'></span></span></li>");var a={menuEl:t,menuItems:[].slice.call(t.querySelectorAll(".menu-item"))},s=t.clientHeight,r=t.scrollHeight;e.menusArr.push(a),i===e.current&&classie.add(t,"menu__level--current"),s==r&&jQuery(t).css("justify-content",n)}),jQuery("body").hasClass("left-static-menu")&&(jQuery(".special-header-menu").css("display","block"),e.animateMenu("openMenu")),this._initEvents()},t.prototype._initEvents=function(){for(var n=this,t=0,i=this.menusArr.length;t<i;++t)this.menusArr[t].menuItems.forEach(function(e,t){0!=jQuery(e).find("span.sub-menu-controller").length&&e.querySelector(".sub-menu-controller").addEventListener("click",function(e){var i=jQuery(e.target).closest(".menu-item")[0].children[0],a=i.getAttribute("data-submenu"),s=i.innerHTML,r=n.el.querySelector('ul[data-menu="'+a+'"]');if(a&&r)e.preventDefault(),n._openSubMenu(r,t,s);else{n.el.querySelector(".menu__link--current")&&classie.remove(n.el.querySelector(".menu__link--current"),"menu__link--current"),classie.add(i,"menu__link--current"),n.options.onItemClick(e,s)}}),"#"!=jQuery(e).find("a").attr("href")&&void 0!==jQuery(e).find("a").attr("href")||e.addEventListener("click",function(e){var i=e.target.getAttribute("data-submenu"),a=e.target.innerHTML,s=n.el.querySelector('ul[data-menu="'+i+'"]');if(i&&s)e.preventDefault(),n._openSubMenu(s,t,a);else{n.el.querySelector(".menu__link--current")&&classie.remove(n.el.querySelector(".menu__link--current"),"menu__link--current"),classie.add(e.target,"menu__link--current"),n.options.onItemClick(e,a)}})});this.options.backCtrl&&jQuery(document).on("click",".menu__back",function(e){n._back()}),jQuery(document).on("click",".hamburger-nav-controller-wrap",function(e){jQuery("body").hasClass("perspective-left")||jQuery("body").hasClass("perspective-right")?jQuery("body").hasClass("perspectiveview-open")?jQuery("body").hasClass("perspectiveview-open")&&n.animateMenu("closeMenu"):n.animateMenu("openMenu"):jQuery("body").hasClass("side-menu-opened")?n.animateMenu("openMenu"):n.animateMenu("closeMenu")}),jQuery(document).on("click","#be-left-strip",function(e){jQuery("body").hasClass("perspective-right")?jQuery("body").hasClass("perspectiveview-open")?jQuery("body").hasClass("perspectiveview-open")&&n.animateMenu("closeMenu"):n.animateMenu("openMenu"):jQuery("body").hasClass("side-menu-opened")?n.animateMenu("openMenu"):n.animateMenu("closeMenu")}),jQuery(document).on("click","#main",function(){(jQuery("body").hasClass("side-menu-opened")||jQuery("body").hasClass("perspectiveview"))&&n.animateMenu("closeMenu")}),jQuery(document).on("click",".be-overlay-menu-close",function(){jQuery("body").hasClass("side-menu-opened")?n.animateMenu("openMenu"):n.animateMenu("closeMenu")}),jQuery(e).on("resize",function(){var e=jQuery(".be-sidemenu").attr("data-menu-alignment"),t=jQuery(".special-header-bottom-text");setTimeout(function(){if(jQuery("body").hasClass("overlay-left-align-menu")&&t.length>0){jQuery(t).css("align-self","auto");t[0].clientHeight==t[0].scrollHeight?jQuery(t).css("align-self",e):jQuery(t).css("align-self","auto")}n.menus.forEach(function(n,t){n.clientHeight==n.scrollHeight?jQuery(n).css("justify-content",e):jQuery(n).css("justify-content","flex-start")})},500)}),document.addEventListener("keyup",function(e){if(jQuery("body").hasClass("side-menu-opened")||jQuery("body").hasClass("perspectiveview")){27===(e.keyCode||e.which)&&n.animateMenu("closeMenu")}})},t.prototype.animateMenu=function(e){var n=this,t=void 0!==n.menusArr[n.current]?n.menusArr[n.current].menuItems:[],i=t.length-1,a=jQuery(".special-header-bottom-text"),r=jQuery(".special-header-logo");0!=n.isAnimating&&void 0!==n.isAnimating||(n.isAnimating=!0,t.forEach(function(t,a){if(t.style.WebkitAnimationDelay=t.style.animationDelay=parseInt(a*n.options.itemsDelayInterval+n.options.initialDelay)+"ms",a==i&&s(t,function(){if("closeMenu"==e)classie.remove(n.menusArr[n.current].menuEl,"animate-closemenu");else if("openMenu"==e)switch(n.options.direction){case"r2l":classie.remove(n.menusArr[n.current].menuEl,"animate-inFromRight");break;case"l2r":classie.remove(n.menusArr[n.current].menuEl,"animate-inFromLeft");break;case"t2b":classie.remove(n.menusArr[n.current].menuEl,"animate-inFromTop");break;case"b2t":classie.remove(n.menusArr[n.current].menuEl,"animate-inFromBottom")}n.isAnimating=!1}),"closeMenu"==e)t.style.WebkitAnimationDelay=t.style.animationDelay=parseInt(0)+"ms",classie.add(n.menusArr[n.current].menuEl,"animate-closemenu"),n.isAnimating=!1;else if("openMenu"==e)switch(n.options.direction){case"r2l":classie.add(n.menusArr[n.current].menuEl,"animate-inFromRight");break;case"l2r":classie.add(n.menusArr[n.current].menuEl,"animate-inFromLeft");break;case"t2b":classie.add(n.menusArr[n.current].menuEl,"animate-inFromTop");break;case"b2t":classie.add(n.menusArr[n.current].menuEl,"animate-inFromBottom")}}));var o=function(t){if("closeMenu"==e)t.removeClass("animate-closemenu");else if("openMenu"==e)switch(n.options.direction){case"r2l":t.removeClass("animate-inFromRight");break;case"l2r":t.removeClass("animate-inFromLeft");break;case"t2b":t.removeClass("animate-inFromTop");break;case"b2t":t.removeClass("animate-inFromBottom")}};if(0!=a.length&&s(a[0],o.bind(null,a)),0!=r.length&&s(r[0],o.bind(null,r)),"closeMenu"==e)a.css("animation-delay",parseInt(0)+"ms"),r.css("animation-delay",parseInt(0)+"ms"),a.addClass("animate-closemenu"),r.addClass("animate-closemenu");else if("openMenu"==e){switch(a.css("animation-delay",parseInt(n.options.initialDelay)+"ms"),r.css("animation-delay",parseInt(n.options.initialDelay)+"ms"),n.options.direction){case"r2l":a.addClass("animate-inFromRight"),r.addClass("animate-inFromRight");break;case"l2r":a.addClass("animate-inFromLeft"),r.addClass("animate-inFromLeft");break;case"t2b":a.addClass("animate-inFromTop"),r.addClass("animate-inFromTop");break;case"b2t":a.addClass("animate-inFromBottom"),r.addClass("animate-inFromBottom")}jQuery("body").hasClass("left-static-menu")&&(a.css("visibility","visible"),r.css("visibility","visible"))}},t.prototype._openSubMenu=function(e,n,t){if(this.isAnimating)return!1;this.isAnimating=!0,this.menusArr[this.menus.indexOf(e)].backIdx=this.current,this.menusArr[this.menus.indexOf(e)].name=t,this._menuOut(n),this._menuIn(e,n)},t.prototype._back=function(){if(this.isAnimating)return!1;this.isAnimating=!0,this._menuOut();var e=this.menusArr[this.menusArr[this.current].backIdx].menuEl;this._menuIn(e),this.options.breadcrumbsCtrl&&this.breadcrumbsCtrl.removeChild(this.breadcrumbsCtrl.lastElementChild)},t.prototype._menuOut=function(e){var n=this,t=this.menusArr[this.current].menuEl,i=void 0===e;switch(this.menusArr[this.current].menuItems.forEach(function(t,a){t.style.WebkitAnimationDelay=t.style.animationDelay=i?parseInt(a*n.options.itemsDelayInterval)+"ms":parseInt(Math.abs(e-a)*n.options.itemsDelayInterval)+"ms"}),this.options.direction){case"r2l":classie.add(t,i?"animate-outToRight":"animate-outToLeft");break;case"l2r":classie.add(t,i?"animate-outToLeft":"animate-outToRight");break;case"t2b":classie.add(t,i?"animate-outToTop":"animate-outToBottom");break;case"b2t":classie.add(t,i?"animate-outToBottom":"animate-outToTop")}},t.prototype._menuIn=function(e,n){var t=this,i=this.menusArr[this.current].menuEl,a=void 0===n,r=this.menus.indexOf(e),o=this.menusArr[r].menuItems,m=o.length;switch(o.forEach(function(o,u){o.style.WebkitAnimationDelay=o.style.animationDelay=a?parseInt(u*t.options.itemsDelayInterval)+"ms":parseInt(Math.abs(n-u)*t.options.itemsDelayInterval)+"ms";u===(n<=m/2||a?m-1:0)&&s(o,function(){switch(t.options.direction){case"r2l":classie.remove(i,a?"animate-outToRight":"animate-outToLeft"),classie.remove(e,a?"animate-inFromLeft":"animate-inFromRight");break;case"l2r":classie.remove(i,a?"animate-outToLeft":"animate-outToRight"),classie.remove(e,a?"animate-inFromRight":"animate-inFromLeft");break;case"t2b":classie.remove(i,a?"animate-outToTop":"animate-outToBottom"),classie.remove(e,a?"animate-inFromBottom":"animate-inFromTop");break;case"b2t":classie.remove(i,a?"animate-outToBottom":"animate-outToTop"),classie.remove(e,a?"animate-inFromTop":"animate-inFromBottom")}classie.remove(i,"menu__level--current"),classie.add(e,"menu__level--current"),t.current=r,t.isAnimating=!1})}),this.options.direction){case"r2l":classie.add(e,a?"animate-inFromLeft":"animate-inFromRight");break;case"l2r":classie.add(e,a?"animate-inFromRight":"animate-inFromLeft");break;case"t2b":classie.add(e,a?"animate-inFromBottom":"animate-inFromTop");break;case"b2t":classie.add(e,a?"animate-inFromTop":"animate-inFromBottom")}},t.prototype._addBreadcrumb=function(e){if(!this.options.breadcrumbsCtrl)return!1;var n=document.createElement("a");n.innerHTML=e?this.menusArr[e].name:this.options.initialBreadcrumb,this.breadcrumbsCtrl.appendChild(n);var t=this;n.addEventListener("click",function(i){if(i.preventDefault(),!n.nextSibling||t.isAnimating)return!1;t.isAnimating=!0,t._menuOut();var a=t.menusArr[e].menuEl;t._menuIn(a);for(var s;s=n.nextSibling;)t.breadcrumbsCtrl.removeChild(s)})},e.MLMenu=t}(window);